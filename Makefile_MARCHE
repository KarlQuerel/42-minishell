NAME        := minishell

SRC_DIR     := src
OBJ_DIR     := obj
INCLUDE_DIR := includes

SRCS        := $(wildcard $(SRC_DIR)/*.c $(SRC_DIR)/parsing/*.c $(SRC_DIR)/executable/*.c $(SRC_DIR)/builtins/*.c)
OBJS        := $(patsubst $(SRC_DIR)/%.c,$(OBJ_DIR)/%.o,$(SRCS))

CC          := cc
CFLAGS      := -Wall -Wextra -Werror
CPPFLAGS    := -I$(INCLUDE_DIR)
LDFLAGS     := -Llibft -lreadline
LDLIBS      := -lft

LIBFT       := libft/libft.a

.PHONY: all clean fclean re

all: $(NAME)

$(NAME): $(OBJS) $(LIBFT)
	$(CC) $(CFLAGS) $(CPPFLAGS) $^ -o $@ $(LDFLAGS) $(LDLIBS)

$(OBJ_DIR)/%.o: $(SRC_DIR)/%.c | $(OBJ_DIR) $(OBJ_DIR)/parsing $(OBJ_DIR)/executable $(OBJ_DIR)/builtins
	$(CC) $(CFLAGS) $(CPPFLAGS) -c $< -o $@

$(OBJ_DIR) $(OBJ_DIR)/parsing $(OBJ_DIR)/executable $(OBJ_DIR)/builtins:
	mkdir -p $@

$(LIBFT):
	make -C libft

clean:
	$(RM) -r $(OBJ_DIR)
	make -C libft clean

fclean: clean
	$(RM) $(NAME)
	make -C libft fclean

re: fclean all
